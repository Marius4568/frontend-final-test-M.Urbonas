!function(){const t=async function(t){try{const e=await fetch(t);return await e.json()}catch(t){return t.message}},e={getAllPeopleFromDB:async function(){try{const e=await t("http://18.193.250.181:1337/api/people?&pagination[pageSize]=100&populate=*");let a=[];for(let n=1;a.length<e.meta.pagination.total;n++){(await t(`http://18.193.250.181:1337/api/people?&pagination[pageSize]=100&pagination[page]=${n}&populate=*`)).data.forEach((t=>a.push(t)))}return a}catch(t){console.log(t.message)}},updateUncapitalizedNames:async function(){let t=await e.getAllPeopleFromDB();t=t.map((t=>[t.attributes.first_name,t.attributes.last_name])),t=t.filter((t=>t[0][0]!==t[0][0].toUpperCase()||t[1][0]!==t[1][0].toUpperCase())),document.querySelector(".not-capitalized-names").textContent=t.length},updateSignupCountries:async function(){let t=await e.getAllPeopleFromDB(),a=[];t.forEach((t=>{const e=t.attributes.country.data;e&&(a.includes(e.attributes.country)||a.push(e.attributes.country))})),document.querySelector(".signup-countries").textContent=a.length},updateTotalSignups:async function(){try{let e=document.querySelector(".signups");const a=await t("http://18.193.250.181:1337/api/people?&pagination[pageSize]=10&populate=country");e.textContent=a.meta.pagination.total}catch(t){console.log(t.message)}},fillSelectCountryElem:async function(e){let a="";const n=await t("http://18.193.250.181:1337/api/countries");n.error?console.log(`Error ${n.error.status}: ${n.error.message}. Couldn't load countries`):n.data.length<1?alert("Empty array, no country data found."):n.data.forEach((t=>{a+=`<option data-id =${t.id} value=${t.attributes.country}>${t.attributes.country}</option>`})),e.innerHTML='<option data-id ="" value="All countries">All countries</option>'+a}},a=document.querySelector("input[type='search']"),n=document.querySelector(".country-select"),o=document.querySelector(".people-info-fields");async function i(e){try{const a=await t(e);o.innerHTML="",a.data.forEach((t=>{o.innerHTML+=`\n    <div class="person-field">\n    <div class="initialsContactInfo">\n      <div class="initials">${t.attributes.first_name[0]+t.attributes.last_name[0]}</div>\n      <div class="contact-info">\n        <p>${t.attributes.first_name+" "+t.attributes.last_name}</p>\n        <span>${t.attributes.email}</span>\n      </div>\n    </div>\n    <div class="country">${t.attributes.country.data?t.attributes.country.data.attributes.country:"No Country"}</div>\n  </div>`}))}catch(t){console.log(t.message)}}function r(t,e){let a="http://18.193.250.181:1337/api/people?&pagination[pageSize]=10&populate=*";return e&&(a+=`&filters[country][id][$eq]=${e}`),t&&(a+=`&filters[$or][0][first_name][$containsi]=${t}&filters[$or][1][last_name][$containsi]=${t}`),a}function s(){return[a.value,n.options[n.selectedIndex].dataset.id]}e.fillSelectCountryElem(n),document.querySelector(".visitors").textContent=Math.floor(5001*Math.random()+5e3),e.updateTotalSignups(),e.updateSignupCountries(),e.updateUncapitalizedNames(),a.addEventListener("keyup",(t=>{if(t.target.value.length>0){const t=s();i(r(t[0],t[1]))}else i("http://18.193.250.181:1337/api/people?&pagination[pageSize]=10&populate=country");t.currentTarget.value})),n.addEventListener("change",(t=>{const e=s();i(r(e[0],e[1]))})),i("http://18.193.250.181:1337/api/people?&pagination[pageSize]=10&populate=*")}();
//# sourceMappingURL=dashboard.496f0224.js.map
