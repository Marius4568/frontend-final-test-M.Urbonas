{"version":3,"sources":["js/asyncFunctions.js","js/dashboard.js"],"names":["asyncFunctions","getData","url","res","fetch","data","json","err","message","postPersonData","dataObject","console","log","JSON","stringify","response","method","headers","body","first_name","last_name","email","country","activities","deletePersonData","id","dashboardAsyncFunctions","getAllPeopleFromDB","array","page","length","meta","pagination","total","forEach","el","push","updateUncapitalizedNames","map","attributes","filter","toUpperCase","document","querySelector","textContent","updateSignupCountries","uniqueCountries","shortcut","includes","updateTotalSignups","signups","fillSelectCountryElem","selectElem","options","countries","error","status","alert","innerHTML","searchField","countrySelect","peopleInfo","Math","floor","random","addEventListener","ev","target","value","searchVals","collectPeopleSearchInputs","query","buildPeopleSearchQuery","displayPeople","currentTarget","searchVal","countryID","selectedIndex","dataset"],"mappings":"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","file":"dashboard.60a5f609.js","sourceRoot":"..\\src","sourcesContent":["export const asyncFunctions = {\r\n  getData: async function (url) {\r\n    try {\r\n      const res = await fetch(url);\r\n      const data = await res.json();\r\n\r\n      return data;\r\n    } catch (err) {\r\n      return err.message;\r\n    }\r\n  },\r\n\r\n  postPersonData: async function (url, dataObject) {\r\n    try {\r\n      console.log(JSON.stringify(dataObject));\r\n      const response = await fetch(url, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          data: {\r\n            first_name: dataObject.first_name,\r\n            last_name: dataObject.last_name,\r\n            email: dataObject.email,\r\n            country: dataObject.country,\r\n            activities: dataObject.activities,\r\n          },\r\n        }),\r\n      });\r\n\r\n      return response.json();\r\n    } catch (err) {\r\n      return err.message;\r\n    }\r\n  },\r\n\r\n  deletePersonData: async function (id) {\r\n    try {\r\n      const res = await fetch(`http://18.193.250.181:1337/api/people/${id}`, {\r\n        method: \"DELETE\",\r\n      });\r\n      const data = await res.json();\r\n\r\n      return data;\r\n    } catch (err) {\r\n      return err.message;\r\n    }\r\n  },\r\n};\r\n\r\nexport const dashboardAsyncFunctions = {\r\n  getAllPeopleFromDB: async function () {\r\n    try {\r\n      const data = await asyncFunctions.getData(\r\n        `http://18.193.250.181:1337/api/people?&pagination[pageSize]=100&populate=*`\r\n      );\r\n\r\n      let array = [];\r\n      for (let page = 1; array.length < data.meta.pagination.total; page++) {\r\n        const data = await asyncFunctions.getData(\r\n          `http://18.193.250.181:1337/api/people?&pagination[pageSize]=100&pagination[page]=${page}&populate=*`\r\n        );\r\n        data.data.forEach((el) => array.push(el));\r\n      }\r\n      return array;\r\n    } catch (err) {\r\n      console.log(err.message);\r\n    }\r\n  },\r\n\r\n  updateUncapitalizedNames: async function () {\r\n    let array = await dashboardAsyncFunctions.getAllPeopleFromDB();\r\n    array = array.map((el) => [\r\n      el.attributes.first_name,\r\n      el.attributes.last_name,\r\n    ]);\r\n    array = array.filter(\r\n      (el) =>\r\n        el[0][0] !== el[0][0].toUpperCase() ||\r\n        el[1][0] !== el[1][0].toUpperCase()\r\n    );\r\n    document.querySelector(\".not-capitalized-names\").textContent = array.length;\r\n  },\r\n\r\n  updateSignupCountries: async function () {\r\n    let array = await dashboardAsyncFunctions.getAllPeopleFromDB();\r\n    let uniqueCountries = [];\r\n    array.forEach((el) => {\r\n      const shortcut = el.attributes.country.data;\r\n      if (shortcut) {\r\n        if (!uniqueCountries.includes(shortcut.attributes.country)) {\r\n          uniqueCountries.push(shortcut.attributes.country);\r\n        }\r\n      }\r\n    });\r\n    document.querySelector(\".signup-countries\").textContent =\r\n      uniqueCountries.length;\r\n  },\r\n\r\n  updateTotalSignups: async function () {\r\n    try {\r\n      let signups = document.querySelector(\".signups\");\r\n      const data = await asyncFunctions.getData(\r\n        \"http://18.193.250.181:1337/api/people?&pagination[pageSize]=10&populate=country\"\r\n      );\r\n      signups.textContent = data.meta.pagination.total;\r\n    } catch (err) {\r\n      console.log(err.message);\r\n    }\r\n  },\r\n\r\n  fillSelectCountryElem: async function (selectElem) {\r\n    let options = ``;\r\n    const countries = await asyncFunctions.getData(\r\n      \"http://18.193.250.181:1337/api/countries\"\r\n    );\r\n\r\n    if (countries.error) {\r\n      console.log(\r\n        `Error ${countries.error.status}: ${countries.error.message}. Couldn't load countries`\r\n      );\r\n    } else if (countries.data.length < 1) {\r\n      alert(`Empty array, no country data found.`);\r\n    } else {\r\n      countries.data.forEach((el) => {\r\n        options += `<option data-id =${el.id} value=${el.attributes.country}>${el.attributes.country}</option>`;\r\n      });\r\n    }\r\n\r\n    selectElem.innerHTML =\r\n      '<option data-id =\"\" value=\"All countries\">All countries</option>' +\r\n      options;\r\n  },\r\n};\r\n","import { asyncFunctions, dashboardAsyncFunctions } from \"./asyncFunctions\";\r\n\r\nconst searchField = document.querySelector(\"input[type='search']\");\r\nconst countrySelect = document.querySelector(\".country-select\");\r\nconst peopleInfo = document.querySelector(\".people-info-fields\");\r\n\r\n//fill the countrySelect element with options\r\ndashboardAsyncFunctions.fillSelectCountryElem(countrySelect);\r\n//fill the visitors card by a random number between 5000 and 10000\r\ndocument.querySelector(\".visitors\").textContent = Math.floor(\r\n  Math.random() * (10000 - 5000 + 1) + 5000\r\n);\r\n//fill the total signups field\r\ndashboardAsyncFunctions.updateTotalSignups();\r\n//fill the signup countries field\r\ndashboardAsyncFunctions.updateSignupCountries();\r\n//fill the uncapitalized names field\r\ndashboardAsyncFunctions.updateUncapitalizedNames();\r\n//Add event listener to the search field\r\nsearchField.addEventListener(\"keyup\", (ev) => {\r\n  if (ev.target.value.length > 0) {\r\n    const searchVals = collectPeopleSearchInputs();\r\n    const query = buildPeopleSearchQuery(searchVals[0], searchVals[1]);\r\n    displayPeople(query);\r\n  } else {\r\n    displayPeople(\r\n      \"http://18.193.250.181:1337/api/people?&pagination[pageSize]=10&populate=country\"\r\n    );\r\n  }\r\n  ev.currentTarget.value;\r\n});\r\n//Add event listener to the country select field\r\ncountrySelect.addEventListener(\"change\", (ev) => {\r\n  const searchVals = collectPeopleSearchInputs();\r\n  const query = buildPeopleSearchQuery(searchVals[0], searchVals[1]);\r\n  displayPeople(query);\r\n});\r\n\r\n//Function to display people on the page\r\nasync function displayPeople(url) {\r\n  try {\r\n    const data = await asyncFunctions.getData(url);\r\n\r\n    peopleInfo.innerHTML = \"\";\r\n\r\n    data.data.forEach((el) => {\r\n      peopleInfo.innerHTML += `\r\n    <div class=\"person-field\">\r\n    <div class=\"initialsContactInfo\">\r\n      <div class=\"initials\">${\r\n        el.attributes.first_name[0] + el.attributes.last_name[0]\r\n      }</div>\r\n      <div class=\"contact-info\">\r\n        <p>${el.attributes.first_name + \" \" + el.attributes.last_name}</p>\r\n        <span>${el.attributes.email}</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"country\">${\r\n      el.attributes.country.data\r\n        ? el.attributes.country.data.attributes.country\r\n        : \"No Country\"\r\n    }</div>\r\n  </div>`;\r\n    });\r\n  } catch (err) {\r\n    console.log(err.message);\r\n  }\r\n}\r\n\r\n//Functions that help to get search inputs and formulate search query/////////////////////////\r\nfunction buildPeopleSearchQuery(searchVal, countryID) {\r\n  let query =\r\n    \"http://18.193.250.181:1337/api/people?&pagination[pageSize]=10&populate=*\";\r\n\r\n  if (countryID) {\r\n    query += `&filters[country][id][$eq]=${countryID}`;\r\n  }\r\n  if (searchVal) {\r\n    query += `&filters[$or][0][first_name][$containsi]=${searchVal}&filters[$or][1][last_name][$containsi]=${searchVal}`;\r\n  }\r\n\r\n  return query;\r\n}\r\n\r\nfunction collectPeopleSearchInputs() {\r\n  return [\r\n    searchField.value,\r\n    countrySelect.options[countrySelect.selectedIndex].dataset.id,\r\n  ];\r\n}\r\n/////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n//initialize people info list\r\ndisplayPeople(\r\n  \"http://18.193.250.181:1337/api/people?&pagination[pageSize]=10&populate=*\"\r\n);\r\n\r\n//sample search for a specific country with the name containing something or the surname containing something\r\n//http://18.193.250.181:1337/api/people?populate=*&filters[country][id][$eq]=7&filters[$or][0][first_name][$containsi]=ll&filters[$or][1][last_name][$containsi]=o\r\n"]}